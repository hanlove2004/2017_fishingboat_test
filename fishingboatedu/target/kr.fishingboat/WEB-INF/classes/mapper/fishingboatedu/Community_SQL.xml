<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="community">

	<!-- (중개인) 공지사항 목록 -->
	<select id="selectNoticeList" parameterType="hashmap" resultType="hashmap">
		<include refid="common.pagingPre"/>
			<![CDATA[
				SELECT
					ROW_NUMBER() OVER (ORDER BY SEQ DESC) RNUM,
					ROW_NUMBER() OVER(ORDER BY REG_DAT desc) AS ROW_SNUM,
					SEQ,
					TITLE,
					CONTENT,
					ISSUSE,
					TO_CHAR(REG_DAT, 'yyyy/mm/dd HH24:MI:SS') AS REG_DAT,
					HIT_CNT,
					DECODE(USR_ID, 'admin', '관리자') AS USR_ID
				FROM 
					TB_BROKE_INFOR_T
				WHERE
					ISSUSE = 'Y'
			]]>
		<include refid="common.pagingPost"/>
	</select>
	
	<!-- (중개인) 공지사항 상세보기 -->
	<select id="selectNoticeDetail" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT
				SEQ,
				TITLE,
				CONTENT,
				ISSUSE,
				TO_CHAR(REG_DAT, 'YYYY-MM-DD') AS REG_DAT,
				HIT_CNT,
				DECODE(USR_ID, 'admin', '관리자') AS USR_ID
			FROM 
				TB_BROKE_INFOR_T
			WHERE 
				SEQ = #{seq}
		]]>
	</select>
	
	<!-- (중개인) 공지사항 상세보기 시 조회수 증가 -->
	<update id="updateNoticeHitCnt" parameterType="hashmap">
		UPDATE 
			TB_BROKE_INFOR_T 
		SET
			HIT_CNT = HIT_CNT + 1
		WHERE 
			SEQ = #{seq}
	</update>

</mapper>

